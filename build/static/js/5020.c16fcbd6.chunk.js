(self.webpackChunkwinston=self.webpackChunkwinston||[]).push([[5020],{71297:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var s=r(65043),i=r(46946),a=r(85865),n=r(29840),l=r(53404),o=r(43360),c=r(87488),u=r(86971),h=r(76371),y=r(68998),p=r(70579);const d=function(){const e=(0,u.Zp)(),t=(0,h.Ay)(),[r,d]=(0,s.useState)({}),v=s.useRef(null),m=e=>{let t=new y.A;if(null!==e){if("-----BEGIN PRIVATE KEY-----"!==e.substr(0,27))return{error:"Invalid Private Key, please try again."};try{t.setPrivateKey(e)}catch(r){return{error:r}}return t.key.isPrivate()?{wallet:t}:{error:"Failed to load key."}}return{error:"Invalid Browser Key"}};return(0,p.jsxs)(i.A,{children:[(0,p.jsx)(a.A,{variant:"h3",children:"Sign in to"}),(0,p.jsx)(a.A,{variant:"h2",sx:{mt:2},children:"Your Wallet"}),(0,p.jsx)(a.A,{variant:"subtitle2",sx:{my:6},children:"Note : Don't lose your wallet key! You have to store your private key in safe place for accessing your wallet."}),(0,p.jsx)(n.A,{fullWidth:!0,variant:"outlined",label:"Password",required:!0,placeholder:"Enter your password",error:r.errors,color:r.errors?"red":"",helperText:r.errors}),(0,p.jsxs)(i.A,{component:"div",sx:{mt:5},children:[(0,p.jsx)(l.A,{variant:"outlined",sx:{mr:{xs:1,md:3}},onClick:r=>{r.preventDefault();const s=m(localStorage.getItem("privateKey"));"error"in s?d(s.error):(t.setAuth(s.wallet),e("/dashboard"))},children:"Browser Login"}),(0,p.jsx)(l.A,{variant:"contained",color:"secondary",onClick:e=>{e.preventDefault(),v.current.firstChild.click()},children:"Private Key"}),(0,p.jsx)(o.A,{onChange:r=>{const s=r.target.files[0],i=new FileReader;i.readAsBinaryString(s),i.onload=()=>{const r=i.result,s=m(r);"error"in s?d(s.error):(t.setAuth(s.wallet),e("/dashboard"))}},name:"privateKeyFile",ref:v,type:"file",sx:{display:"none"}})]}),(0,p.jsxs)(a.A,{sx:{mt:5},children:["Don\u2019t have an wallet?",(0,p.jsx)(c.A,{underline:"none",onClick:()=>e("/sign-up"),sx:{ml:1},children:"Let\u2019s create your wallet"})]})]})}},68998:(e,t,r)=>{"use strict";r.d(t,{A:()=>o});var s=r(26382).Buffer,i=r(86316),a=r(55742);const n="-----BEGIN PUBLIC KEY-----",l="-----END PUBLIC KEY-----";class o{constructor(){return this.key=new i,this}generateKeyPair(){return this.key.generateKeyPair(512),this.walletPrivateKey=this.key.exportKey("pkcs8-private-pem"),this.walletPublicKey=(()=>{const e=this.key.exportKey("pkcs8-public-pem").split("\n");return e.shift(),{a:e.shift(),b:e.shift()}})(),this}setPublicKey(e){const t=new i;return t.importKey([n,e.a,e.b,l].join("\n"),"pkcs8-public-pem"),t.isPublic()&&(this.key=t,this.walletPublicKey=(()=>{const e=t.exportKey("pkcs8-public-pem").split("\n");return e.shift(),{a:e.shift(),b:e.shift()}})()),this}setPrivateKey(e){const t=new i;return t.importKey(e,"pkcs8-private-pem"),t.isPrivate()&&(this.key=t,this.walletPrivateKey=t.exportKey("pkcs8-private-pem"),this.walletPublicKey=(()=>{const e=t.exportKey("pkcs8-public-pem").split("\n");return e.shift(),{a:e.shift(),b:e.shift()}})()),this.key.isPrivate()}verifySignature(e){this.setPublicKey(e.sender);const t={sender:e.sender,amount:e.amount,receiver:e.receiver,data:[{message:e.data[0].message}],timestamp:e.timestamp,txPreviousHash:e.txPreviousHash};return console.log(t),this.key.verify(t,new s.from(e.signature))}signTransaction(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"A message from me to you!";const i={sender:this.walletPublicKey,amount:e,receiver:t,data:[{message:s}],timestamp:Date.now(),txPreviousHash:r};return i.signature=this.key.sign(i),i}getQRImage(){var e=a.qrcode(8,"M");let t=[this.walletPublicKey.a,this.walletPublicKey.b].join("\n");return e.addData(t),e.make(),e.createImgTag(2)}}},78982:()=>{},47790:()=>{},73776:()=>{},21638:()=>{},92668:()=>{},77965:()=>{},66089:()=>{},79368:()=>{},64688:()=>{},51069:()=>{},15340:()=>{},79838:()=>{}}]);
//# sourceMappingURL=5020.c16fcbd6.chunk.js.map